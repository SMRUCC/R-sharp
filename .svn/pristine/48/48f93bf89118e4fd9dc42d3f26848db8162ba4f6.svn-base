Module Program

    Sub Main()


        ' VB/C# with R language hybrid programming example

        Dim ChipData = (From row As Microsoft.VisualBasic.DataVisualization.DocumentFormat.Csv.File.RowObject
                        In Microsoft.VisualBasic.DataVisualization.DocumentFormat.Csv.File.FastLoad("../DM_1184.GeneChipDataSamples.csv")
                        Select ID = row.First, ExpressionData0 = (From s As String In row.Skip(1) Select Val(s)).ToArray).ToArray
        Call Wavelets.Initialize()
        Dim TestResultRS4Object = Wavelets.DWT_RInvoke(ChipData.First.ExpressionData0, filter:="haar")
        Dim Result = RDotNET.Extensions.ShellScriptAPI.Serialization.LoadFromStream(Of Wavelets.Waveletmodwt)(TestResultRS4Object)

        Call Result.GetXml.SaveTo("./Test.Result.xml")




		
		



        'Shoal Shell Script programming example

        Dim ShoalShell As Microsoft.VisualBasic.Scripting.ShoalShell.Runtime.Objects.ShellScript = New Scripting.ShoalShell.Runtime.Objects.ShellScript()

        Call ShoalShell.InstallModules(GetType(RDotNET.Extensions.ShellScriptAPI.Serialization).Assembly.Location)
        Call ShoalShell.InstallModules(GetType(Wavelets).Assembly.Location)
        Call ShoalShell.InstallModules(GetType(ShoalShell.PlugIns.Plot_Devices.DataSource).Assembly.Location)

        Call ShoalShell.TypeLibraryRegistry.Save()

        Dim Script As String =
<ShoalShell-Script>
imports wavelets
imports r.net
imports io_device.csv
imports system

chipdata &lt; (imports.csv) ../DM_1184.GeneChipDataSamples.csv
chipdata &lt;- $chipdata -> as.datasource
chipdata &lt;= $chipdata [0]
chipdata &lt;- $chipdata -> get.X

s4obj &lt;- $chipdata -> dwt.r.invoke filter haar n.levels 5 
result.type &lt;- wavelets result.type.schema
result &lt;- ctype r.data $s4obj cast.type $result.type

call $result > ./Test.Result.ShoalInvoke.xml

return $result
</ShoalShell-Script>

        Dim bResult = ShoalShell <= Script  'Execute the script and gets the return value

        MsgBox(DirectCast(bResult, Wavelets.Waveletmodwt).GetXml, MsgBoxStyle.Information)





		
		
		

        ' Shoal Shell VB/C# dynamics programming example

        Dim Dynamics As Object = New Microsoft.VisualBasic.Scripting.ShoalShell.Runtime.Objects.Dynamics(ShoalShell)

        '  ---------------------------Translate version of the shell shell scripting show above---------------------------------
        Dim ChipDataDy = Dynamics.Imports.Csv("../DM_1184.GeneChipDataSamples.csv")
        ChipDataDy = Dynamics.As.DataSource(ChipDataDy)
        ChipDataDy = ChipDataDy(0)
        ChipDataDy = Dynamics.Get.X(ChipDataDy)

        Dim s4obj = Dynamics.dwt.r.invoke(ChipDataDy)
        Result = DirectCast(Dynamics.CType(s4obj, GetType(Wavelets.Waveletmodwt)), Wavelets.Waveletmodwt)
        '  ---------------------------------------------------------------------------------------------------------------------

        Result.GetXml.SaveTo("./Test.Result.ShoalInvoke.Dynamics.Programming.xml")
        MsgBox(DirectCast(Result, Wavelets.Waveletmodwt).GetXml, MsgBoxStyle.Information)
    End Sub
End Module
